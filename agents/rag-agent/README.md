# RAG Agent - ì˜ë¯¸ë¡ ì  ê²€ìƒ‰ ë° ì½”ìŠ¤ ìµœì í™”

DayToCourse íŒ€ í”„ë¡œì íŠ¸ì˜ RAG Agent êµ¬ì„±ìš”ì†Œì…ë‹ˆë‹¤.

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

### ğŸ“Š RAG Agent í•µì‹¬ ì—­í• 
- **ì˜ë¯¸ë¡ ì  ê²€ìƒ‰**: OpenAI Embedding + Qdrant ë²¡í„° DBë¥¼ í™œìš©í•œ ì§€ëŠ¥ì  ì¥ì†Œ ê²€ìƒ‰
- **ì½”ìŠ¤ ìµœì í™”**: ê±°ë¦¬ ê³„ì‚° ë° ì¡°í•© ìƒì„±ì„ í†µí•œ ìµœì  ë°ì´íŠ¸ ì½”ìŠ¤ êµ¬ì„±
- **GPT ê¸°ë°˜ ì¶”ì²œ**: GPT-4o minië¥¼ í™œìš©í•œ ê°œì¸í™”ëœ ì½”ìŠ¤ ì„ íƒ ë° ì¶”ì²œ ì´ìœ  ìƒì„±

### ğŸš€ ì„±ëŠ¥ íŠ¹ì§•
- **ë³‘ë ¬ ì²˜ë¦¬**: ë§‘ì„ ë•Œ/ë¹„ì˜¬ ë•Œ ì‹œë‚˜ë¦¬ì˜¤ ë™ì‹œ ì²˜ë¦¬ (2-4ì´ˆ ë‹¨ì¶•)
- **3ë‹¨ê³„ ì¬ì‹œë„ ì „ëµ**: Top3 â†’ Top5 â†’ ë°˜ê²½í™•ëŒ€ (ê²€ìƒ‰ ì„±ê³µë¥  95%)
- **ì˜ˆìƒ ì²˜ë¦¬ ì‹œê°„**: 4-6ì´ˆ

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
agents/rag-agent/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.py                 # ë©”ì¸ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”œâ”€â”€ core/                   # í•µì‹¬ RAG ë¡œì§
â”‚   â”‚   â”œâ”€â”€ embedding_service.py    # OpenAI ì„ë² ë”©
â”‚   â”‚   â”œâ”€â”€ course_optimizer.py     # ì½”ìŠ¤ ìµœì í™”
â”‚   â”‚   â”œâ”€â”€ weather_processor.py    # ë‚ ì”¨ë³„ ë¶„ê¸°
â”‚   â”‚   â””â”€â”€ radius_calculator.py    # ê²€ìƒ‰ ë°˜ê²½ ê³„ì‚°
â”‚   â”œâ”€â”€ database/               # ë²¡í„° DB ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ qdrant_client.py        # Qdrant í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ vector_search.py        # ë²¡í„° ê²€ìƒ‰
â”‚   â”‚   â””â”€â”€ schema.py               # ë°ì´í„° ìŠ¤í‚¤ë§ˆ
â”‚   â”œâ”€â”€ agents/                 # AI ì—ì´ì „íŠ¸
â”‚   â”‚   â”œâ”€â”€ gpt_selector.py         # GPT ê¸°ë°˜ ì„ íƒ
â”‚   â”‚   â”œâ”€â”€ prompt_templates.py     # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”‚   â”‚   â””â”€â”€ retry_handler.py        # ì¬ì‹œë„ ë¡œì§
â”‚   â”œâ”€â”€ models/                 # ë°ì´í„° ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ request_models.py       # ìš”ì²­ ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ response_models.py      # ì‘ë‹µ ëª¨ë¸
â”‚   â”‚   â””â”€â”€ internal_models.py      # ë‚´ë¶€ ëª¨ë¸
â”‚   â””â”€â”€ utils/                  # ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ data_validator.py       # ë°ì´í„° ê²€ì¦
â”‚       â”œâ”€â”€ distance_calculator.py  # ê±°ë¦¬ ê³„ì‚°
â”‚       â”œâ”€â”€ diversity_manager.py    # ë‹¤ì–‘ì„± ê´€ë¦¬
â”‚       â”œâ”€â”€ location_analyzer.py    # ìœ„ì¹˜ ë¶„ì„
â”‚       â””â”€â”€ parallel_executor.py    # ë³‘ë ¬ ì²˜ë¦¬
â”œâ”€â”€ config/                     # ì„¤ì • ê´€ë¦¬
â”‚   â”œâ”€â”€ settings.py                 # ì‹œìŠ¤í…œ ì„¤ì •
â”‚   â””â”€â”€ api_keys.py                 # API í‚¤ ê´€ë¦¬
â”œâ”€â”€ data/                       # ë°ì´í„° ë° ì´ˆê¸°í™”
â”‚   â”œâ”€â”€ initialize_db.py            # ë²¡í„° DB ì´ˆê¸°í™”
â”‚   â”œâ”€â”€ load_final_data.py          # ë°ì´í„° ë¡œë”©
â”‚   â”œâ”€â”€ run_loading.sh              # ë°ì´í„° ë¡œë”© ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ places/                     # ì¥ì†Œ ë°ì´í„° (JSON)
â”œâ”€â”€ requirements.txt            # ì˜ì¡´ì„± íŒ¨í‚¤ì§€
â”œâ”€â”€ run_server.py              # ì„œë²„ ì‹¤í–‰
â””â”€â”€ start_server.py            # ì„œë²„ ì‹œì‘
```

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

- **AI Framework**: LangChain, OpenAI GPT-4o mini
- **Vector DB**: Qdrant (ì˜ë¯¸ë¡ ì  ê²€ìƒ‰ìš©)
- **Web Framework**: FastAPI (ë¹„ë™ê¸° ì²˜ë¦¬)
- **Async Processing**: asyncio (ë³‘ë ¬ ì²˜ë¦¬)
- **Data Validation**: Pydantic (ì—„ê²©í•œ ë°ì´í„° ê²€ì¦)

## ğŸ“Š ì²˜ë¦¬ íë¦„

1. **ìš”ì²­ ìˆ˜ì‹ **: Main Agentë¡œë¶€í„° JSON ìš”ì²­ ë°›ê¸°
2. **ë³‘ë ¬ ë¶„ê¸°**: ë§‘ì„ ë•Œ/ë¹„ì˜¬ ë•Œ ì‹œë‚˜ë¦¬ì˜¤ ë³‘ë ¬ ì²˜ë¦¬
3. **ë²¡í„° ê²€ìƒ‰**: 3ë‹¨ê³„ ì¬ì‹œë„ ì „ëµ (Top3 â†’ Top5 â†’ ë°˜ê²½í™•ëŒ€)
4. **ì¡°í•© ìƒì„±**: ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ ì¡°í•© ìƒì„± ë° ê±°ë¦¬ ê³„ì‚°
5. **GPT ì„ íƒ**: ìµœì  ì½”ìŠ¤ 3ê°œ ì„ íƒ ë° ì¶”ì²œ ì´ìœ  ìƒì„±
6. **ê²°ê³¼ í†µí•©**: ìµœì¢… ì‘ë‹µ ìƒì„±

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
cd agents/rag-agent
pip install -r requirements.txt
```

### 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```bash
# .env íŒŒì¼ ìƒì„±
OPENAI_API_KEY=your_openai_api_key_here
QDRANT_HOST=localhost
QDRANT_PORT=6333
```

### 3. ë²¡í„° DB ì´ˆê¸°í™”
```bash
cd data
python initialize_db.py
```

### 4. ì„œë²„ ì‹¤í–‰
```bash
# API ì„œë²„ë¡œ ì‹¤í–‰
python run_server.py

# ë˜ëŠ” ì§ì ‘ ì‹¤í–‰
python src/main.py
```

## ğŸ”„ Main Agentì™€ ì—°ë™

### API í˜¸ì¶œ ë°©ì‹
```python
import requests

response = requests.post(
    "http://localhost:8000/recommend-course",
    json={
        "request_id": "req-001",
        "timestamp": "2025-06-30T15:30:00Z",
        "search_targets": [...],
        "user_context": {...},
        "course_planning": {...}
    }
)
```

### ì‘ë‹µ í˜•ì‹
```json
{
  "request_id": "req-001",
  "processing_time": "4.2ì´ˆ",
  "status": "success",
  "results": {
    "sunny_weather": [
      {
        "course_id": "sunny_course_1",
        "places": [...],
        "travel_info": [...],
        "recommendation_reason": "GPT ìƒì„± ì¶”ì²œ ì´ìœ "
      }
    ],
    "rainy_weather": [...]
  }
}
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

- **ë³‘ë ¬ ì²˜ë¦¬**: ì„ë² ë”© ìƒì„±ê³¼ ë°˜ê²½ ê³„ì‚° ë™ì‹œ ì‹¤í–‰
- **ì¬ì‹œë„ ì „ëµ**: í•„ìš”ì‹œì—ë§Œ ì¶”ê°€ ê²€ìƒ‰ ìˆ˜í–‰
- **ìŠ¤ë§ˆíŠ¸ ìºì‹±**: ìì£¼ ì‚¬ìš©ë˜ëŠ” ê²°ê³¼ ìºì‹±
- **ì§ì„ ê±°ë¦¬**: Haversine ê³µì‹ ì‚¬ìš©ìœ¼ë¡œ ë¹ ë¥¸ ê±°ë¦¬ ê³„ì‚°

## ğŸš¨ ì˜ˆì™¸ ì²˜ë¦¬

- **ì™„ì „ ì‹¤íŒ¨**: 3ì°¨ ì‹œë„ê¹Œì§€ ëª¨ë‘ ì‹¤íŒ¨ ì‹œ ëŒ€ì•ˆ ì œì•ˆ
- **ë¶€ë¶„ ì„±ê³µ**: í•œ ë‚ ì”¨ ì¡°ê±´ë§Œ ì„±ê³µ ì‹œ ë¶€ë¶„ ê²°ê³¼ ì œê³µ
- **íƒ€ì„ì•„ì›ƒ**: 30ì´ˆ ë‚´ ì‘ë‹µ ë³´ì¥

## ğŸ‘¥ íŒ€ í˜‘ì—…

### Git ë¸Œëœì¹˜ ì „ëµ
- **ë¸Œëœì¹˜**: `feature/rag-agent`
- **ì—­í• **: RAG Agent ê°œë°œ ë° ìœ ì§€ë³´ìˆ˜
- **í†µí•©**: `develop` ë¸Œëœì¹˜ë¡œ ë³‘í•©

### ë‹¤ë¥¸ Agentì™€ì˜ ì—°ë™
- **Main Agent**: ìš”ì²­ ìˆ˜ì‹  ë° ì‘ë‹µ ì „ë‹¬
- **Place Agent**: ì¢Œí‘œ ì •ê·œí™” í˜‘ë ¥
- **Weather Agent**: ë‚ ì”¨ ì •ë³´ ì—°ë™

## ğŸ” ë³´ì•ˆ

- **API í‚¤**: í™˜ê²½ë³€ìˆ˜ë¡œ ì•ˆì „í•˜ê²Œ ê´€ë¦¬
- **ì…ë ¥ ê²€ì¦**: Pydanticìœ¼ë¡œ ì—„ê²©í•œ ë°ì´í„° ê²€ì¦
- **ì—ëŸ¬ ì²˜ë¦¬**: ë¯¼ê°í•œ ì •ë³´ ë…¸ì¶œ ë°©ì§€